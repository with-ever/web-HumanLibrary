<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.withever.humanlibrary.repo.mapper.SubCategoryMapper">
	<resultMap id="subCategoryResultMap" type="SubCategory">
		<id property="id" column="ID"/>
		<result property="categoryName" column="CATEGORY_NAME"/>
		<result property="desc" column="DESC"/>
		<result property="parentCategoryId" column="PARENT_CATEGORY_ID"/>
	</resultMap>
	
	<select id="selectSubCategoriesBySearch" parameterType="SubCategorySearch" resultMap="subCategoryResultMap">
		SELECT
			ID
			,CATEGORY_NAME
			,PARENT_CATEGORY_ID
		FROM
			SUB_CATEGORY
	</select>
	
	<select id="selectSubCategoriesTotalCountBySearch" parameterType="SubCategorySearch" resultType="int">
		SELECT
			COUNT(*)
		FROM
			SUB_CATEGORY
	</select>
	
	<select id="selectParentCategoryIdByName" parameterType="String" resultType="Long">
		SELECT
			ID
		FROM 
			CATEGORY
		WHERE
			CATEGORY_NAME = #{categoryName}
	</select>
	
	<select id="selectChildCategoriesBySearch" parameterType="SubCategorySearch" resultMap="subCategoryResultMap">
		SELECT
			ID
			,CATEGORY_NAME
			,PARENT_CATEGORY_ID
		FROM
			SUB_CATEGORY
		WHERE
			PARENT_CATEGORY_ID = #{id}
	</select>
	
	<insert id="insertSubCategory" parameterType="SubCategory" useGeneratedKeys="true" keyProperty="id" keyColumn="ID">
		INSERT INTO SUB_CATEGORY(
			ID
			,CATEGORY_NAME
			,`DESC`
			,PARENT_CATEGORY_ID
		)
		VALUES(
			#{id}
			,#{categoryName}
			,#{desc}
			,#{parentCategoryId}
		)
	</insert>
	
	<update id="updateSubCategory" parameterType="SubCategory">
		UPDATE
			SUB_CATEGORY
		SET
			CATEGORY_NAME = #{categoryName}
			,`DESC` = #{desc}
			,PARENT_CATEGORY_ID = #{parentCategoryId}
		WHERE
			ID = #{id}
	</update>
	
	<delete id="deleteSubCategory" parameterType="Long">
		DELETE
		FROM
			SUB_CATEGORY
		WHERE
			ID = #{id}
	</delete>
	
	<select id="selectSubCategory" parameterType="Long" resultMap="subCategoryResultMap">
		SELECT 
			ID
			,CATEGORY_NAME
			,`DESC`
			,PARENT_CATEGORY_ID
		FROM
			SUB_CATEGORY
		WHERE
			ID = #{id}
	</select>
	
	<select id="selectSubCategoryByCategoryName" parameterType="String" resultMap="subCategoryResultMap">
		SELECT 
			ID
			,CATEGORY_NAME
			,`DESC`
			,PARENT_CATEGORY_ID
		FROM
			SUB_CATEGORY
		WHERE
			CATEGORY_NAME = #{categoryName}
	</select>
	
	<select id="countSubCategory" resultType="int">
		SELECT
			COUNT(*)
		FROM
			SUB_CATEGORY
	</select>
	
</mapper>